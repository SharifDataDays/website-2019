{% extends 'accounts/panel/panel.html' %}
{% load static i18n ai_filters tz %}
{% get_current_language_bidi as LANGUAGE_BIDI %}

{% block panel_content %}


{#  Get New Trial Button #}
{% if phase.type == 'online_phase_1' %}
<div>
    <div class="ui blue message" style="width: 100%; display: block; font-size: 2em; font-family: IRANSans; text-align: center">
            {{ name }}
        </div>
    <div class="ui" style="font-family: IRANSans; font-weight: 200; border: 1px solid #E8E8E8; border-radius:.28571429rem .28571429rem 0 0; padding: 5%;">

        <div class="ui blue message" style="padding: 5%; text-align: center">
            دقت کنید در طول فاز اول مسابقه نهایتا پنج تلاش خواهید داشت
            <br>
            <br>
            با زدن دکمه زیر تنها پنج ساعت فرصت دارید تا جواب تلاش تولیدشده را ارسال کنید. و پس از آن امتیاز صفر برای تلاش ثبت می‌شود.
        </div>
        <a
          class="fluid ui button blue"
          style="margin: 20px 0px"
          href="{% url 'accounts:new_trial' phase.id %}"
        >
          {% trans 'Get a new trial' %}
      </a>
        <div class="ui blue message" style="padding: 5%; text-align: center">
            امتیاز فاز اول مسابقه میانگین امتیاز تلاش‌ها پس از حذف کمترین امتیاز است.
        </div>
    </div>
</div>
{% elif phase.type == 'online_phase_2' %}
<div>
    <div class="ui blue message" style="width: 100%; display: block; font-size: 2em; font-family: IRANSans; text-align: center">
            {{ name }}
        </div>

    <div class="ui" style="font-family: IRANSans; font-weight: 200; border: 1px solid #E8E8E8; border-radius:.28571429rem .28571429rem 0 0; padding: 5%;">

        <div class="ui warning message blue" style="padding: 5%; text-align: center">
در روز آخر مسابقه، تعداد دفعات آپلود مجاز از ۳ به ۱۰ تغییر کرد.<br><br>
توجه داشته‌باشید که امتیاز شما در جدول امتیازات، با نیمی از دادگان ارسال نهایی محاسبه ‌می‌شود.<br>
        </div>
        <a
          class="fluid ui button blue"
          style="margin: 20px 0px"
          href="{% url 'accounts:new_trial' phase.id %}"
        >
          {% trans 'Get a new trial' %}
      </a>
        <div class="ui warning message blue" style="padding: 5%; text-align: center">
                        امتیاز نهایی شما (مؤثر در صعود به مرحله حضوری) با نیمه دیگر دادگان ارسال نهایی محاسبه ‌خواهدشد.
        </div>
    </div>
</div>
{% elif phase.type == 'onsite_day_1' %}
<div>
    <div class="ui blue message" style="width: 100%; display: block; font-size: 2em; font-family: IRANSans; text-align: center">
            {{ name }}
        </div>

    <div class="ui" style="font-family: IRANSans; font-weight: 200; border: 1px solid #E8E8E8; border-radius:.28571429rem .28571429rem 0 0; padding: 5%;">

        <div class="ui warning message blue" style="padding: 5%; text-align: center">
            در اولین روز از مرحله حضوری، با سوالاتی روی دادگان اصلی دیوار، با محوریت تحلیل داده روبرو هستید.
            <br>
            <br>
            دقت کنید که در این سوالات به هیچ عنوان یک پاسخ خاص صحیح نیست و امتیاز شما تابعی از صحت پاسخ‌های شما و کیفیت گزارش شما خواهد بود.
            <br>
            <br>
            گزارش ارائه‌شده باید شامل توصیف روش، تکه‌کدهای پیاده‌سازی شده، نتایج، بحث روی نتایج و مراجع استفاده شده باشد.
            <br>
        </div>

        <div class="ui warning message red" style="padding: 5%; text-align: center">
            دقت کنید تنها می‌توانید یک تلاش ارسال کنید!
            <br>
            <br>
            و تنها در صورتی می‌توانید در مسابقه بعدی شرکت کنید که برای این مسابقه یک تلاش ارسال کرده باشید.
            <br>
            <br>
        </div>

        <a
          class="fluid ui button blue"
          style="margin: 20px 0px"
          href="{% url 'accounts:new_trial' phase.id %}"
        >
          {% trans 'Get a new trial' %}
      </a>
        <div class="ui warning message blue" style="padding: 5%; text-align: center">
            امتیاز شما در این فاز تنها در پایان روز و با تلاش نهایی شما، محاسبه می‌شود و از طریق سایت در دسترس قرار می‌گیرد.
        </div>
    </div>
</div>
{% elif phase.type == 'onsite_day_1_2' %}
<div>
    <div class="ui blue message" style="width: 100%; display: block; font-size: 2em; font-family: IRANSans; text-align: center">
            {{ name }}
        </div>

    <div class="ui" style="font-family: IRANSans; font-weight: 200; border: 1px solid #E8E8E8; border-radius:.28571429rem .28571429rem 0 0; padding: 5%;">

        <div class="ui warning message blue" style="padding: 5%; text-align: center">
            در این بخش باید تابعی با توانایی تولید یک نمودار با توجه به آرگومان‌های ورودی بنویسید.
            <br>
            <br>
            همچنین کدهای شما باید تا حد امکان پاکسازی شده و قابل بازتولید باشد.
            <br>
            <br>
            در نهایت مهم‌ترین بخش نمره شما، مانند مسابقه قبلی، گزارش است که باید شامل توصیف روش، تکه‌کدهای استفاده‌شده، نتایج و بحث روی آن‌ها در نهایت و مراجع استفاده شده باشد.
        </div>

        <div class="ui warning message red" style="padding: 5%; text-align: center">
            دقت کنید تنها می‌توانید یک تلاش برای هر قسمت ارسال کنید!
            <br>
            <br>
            و تنها در صورتی می‌توانید در قسمت دوم شرکت کنید که برای قسمت اول یک تلاش ارسال کرده باشید.
            <br>
            (می‌توانید با ارسال فایل‌های خالی به قسمت اول، از آن گذر کرده و به قسمت دوم وارد شوید. منتهی امکان ارسال مجدد برای قسمت اول وجود ندارد.)
            <br>
        </div>

        <a
          class="fluid ui button blue"
          style="margin: 20px 0px"
          href="{% url 'accounts:new_trial' phase.id %}"
        >
          {% trans 'Get a new trial' %}
      </a>
        <div class="ui warning message blue" style="padding: 5%; text-align: center">
            امتیاز شما در این فاز تنها در پایان روز و با تلاش نهایی شما، محاسبه می‌شود و از طریق سایت در دسترس قرار می‌گیرد.
        </div>
    </div>
</div>
{% elif phase.type == 'onsite_day_2' %}
<div>
    <div class="ui blue message" style="width: 100%; display: block; font-size: 2em; font-family: IRANSans; text-align: center">
            {{ name }}
        </div>

    <div class="ui" style="font-family: IRANSans; font-weight: 200; border: 1px solid #E8E8E8; border-radius:.28571429rem .28571429rem 0 0; padding: 5%;">

        <div class="ui warning message blue" style="padding: 5%; text-align: center">

        </div>
        <a
          class="fluid ui button blue"
          style="margin: 20px 0px"
          href="{% url 'accounts:new_trial' phase.id %}"
        >
          {% trans 'Get a new trial' %}
      </a>
        <div class="ui warning message blue" style="padding: 5%; text-align: center">
                        امتیاز نهایی شما (مؤثر در صعود به مرحله حضوری) با نیمه دیگر دادگان ارسال نهایی محاسبه ‌خواهدشد.
        </div>
    </div>
</div>
{% endif %}
<div style="display: block">
    <div class="ui three column grid center aligned container stackable">
    {% for trial in trials%}
        <div class="ui button center aligned one column grid" style="cursor:initial;background-color: transparent!important; margin-bottom: 7%; margin-top:3%"
             data-tooltip="
                {% if phase.trial_submit_type == 'FINAL' %}
                    {% trans 'Score ' %}:
                    {% if trial.score == -1 %}
                        {% trans 'Judging ...' %}
                    {% else %}
                        {{ trial.score|floatformat:2 }}
                    {% endif %}
                {% else %}
                    {% trans 'Part One Score' %}:
                    {{ trial|score:'1' }},
                    {% trans 'Part Two Score' %}:
                    {{ trial|score:'2' }},
                    {% trans 'Part Three Score' %}:
                    {{ trial|score:'3' }}
                {% endif %}" data-position="bottom center">

            <div>
                {% if trial.view_trial %}
                    <div  class="ui card link active panel_phase" style="background-color: #d1f0ff">
                {% else %}
                    <div class="ui card panel_phase">
                {% endif %}
                        <div class="content"
                            {% if trial.is_final == True %}
                                style="background-color: rgb(49,102,155);"
                            {% endif %}
                            >
                            <div class="header"
                                {% if trial.is_final == True %}
                                    style="color:white;"
                                {% endif %}
                            >
                                {% trans 'Trial' %} {{ forloop.revcounter }}
                            </div>
                        </div>
                        <div class="content">

                            {# Trial's Start Time  #}
                            <h4 class="ui sub header">
                                {% trans 'Start Time' %}
                            </h4>
                            {{ trial.start_time }}

                            {# Trial's Time Left #}
                            {# {% if forloop.counter == trials|length %}#}
                            {% if trial.view_trial %}
                                <h4 class="ui sub header">
                                {% trans 'Time Left' %}
                                </h4>
                                <span>{{ trial.end_time|timeuntil }}</span>
                            {% endif %}
                            {# {% endif %}#}

                            {# Trial's Submit Time : ( display None for not submitted Trials ) #}
                            {% if trial.submit_time != None %}
                                <h4 class="ui sub header">
                                {% trans 'Submit Time' %}
                                </h4>
                                {{ trial.submit_time|timesince }}
                            {% endif %}

                            {# Trial's Score #}
                                <h4 class="ui sub header">
                                    {% trans 'Score ' %}
                                </h4>
                                {% if trial.score == -1 %}
                                    {% trans 'Judging ...' %}
                                {% else %}
                                    {{ trial.score|floatformat:2 }}
                                {% endif %}


                            {% if phase.trial_submit_type == 'FINAL' and not trial.view_trial %}
                                {% if trial.is_final == False %}
                                <form enctype="multipart/form-data" action="{% url 'accounts:set_final_trial' phase.id trial.id %}" class="form" method="post">
                                    {% csrf_token %}
                                    <button class="ui compact fluid button" style="margin: 20px 0;" type="submit">
                                        <p>{% trans 'set as final trial' %}</p>
                                    </button>
                                </form>
                                {% endif %}
                                {% if trial.is_final == True %}
                                    <div class="ui compact fluid label" style="margin: 20px 0; background-color: rgb(49,102,155); color: white" >
                                        <p>{% trans 'final trial' %}</p>
                                    </div>
                                {% endif %}
                            {% endif %}
                            {% if trial.view_trial %}
                                <div class="ui compact green fluid label" style="margin: 20px 0; background-color: rgb(49,102,155); color: white" >
                                    <a href="{% url 'accounts:panel_trial' phase.id trial.id %}">
                                        <p style="color: white">{% trans 'View Trial' %}</p>
                                    </a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
            </div>
        </div>
    {% endfor %}
    </div>
    </div>
{% endblock %}
</div>